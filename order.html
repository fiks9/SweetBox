<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è - SweetBox">
    <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è - SweetBox</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet"
        media="print" onload="this.media='all'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap"
            rel="stylesheet">
    </noscript>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/new-styles.css">
</head>

<body>
    <header id="site-header" class="header"></header>

    <main class="main">
        <section class="order-page">
            <div class="container">
                <h1 class="order-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h1>

                <div class="order-content">
                    <!-- –¢–æ–≤–∞—Ä–∏ -->
                    <div class="order-items animate-on-scroll">
                        <h2 class="order-subtitle">–í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
                        <div class="order-list" id="order-items-list">
                            <!-- –ó–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è JavaScript -->
                        </div>
                        <div class="order-total-block">
                            <span class="order-total-label">–†–∞–∑–æ–º:</span>
                            <span class="order-total-value" id="order-total">0 ‚Ç¥</span>
                        </div>
                    </div>

                    <!-- –§–æ—Ä–º–∞ -->
                    <div class="order-form-wrapper animate-on-scroll">
                        <h2 class="order-subtitle">–î–∞–Ω—ñ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏</h2>
                        <form class="order-form" id="order-form">
                            <div class="form-group">
                                <label class="form-label">–Ü–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ *</label>
                                <input type="text" class="form-input" id="order-name" required
                                    placeholder="–û–ª–µ–Ω–∞ –ü–µ—Ç—Ä–µ–Ω–∫–æ">
                            </div>
                            <div class="form-group">
                                <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                                <input type="tel" class="form-input" id="order-phone" required
                                    placeholder="+380 –•–• –•–•–• –•–• –•–•" pattern="^\+?[0-9\s\-]{10,15}$"
                                    title="–í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-input" id="order-email" placeholder="email@example.com">
                            </div>

                            <div class="form-group">
                                <label class="form-label">–°–ø–æ—Å—ñ–± –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="delivery" value="nova-poshta" required>
                                        <span class="radio-text">–ù–æ–≤–∞ –ü–æ—à—Ç–∞ (–≤—ñ–¥ 50 ‚Ç¥)</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="delivery" value="courier">
                                        <span class="radio-text">–ö—É—Ä'—î—Ä –ø–æ –õ—å–≤–æ–≤—É (150 ‚Ç¥)</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="delivery" value="pickup">
                                        <span class="radio-text">–°–∞–º–æ–≤–∏–≤—ñ–∑ (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                                <input type="text" class="form-input" id="order-address"
                                    placeholder="–ú—ñ—Å—Ç–æ, –≤—É–ª–∏—Ü—è, –±—É–¥–∏–Ω–æ–∫, –∫–≤–∞—Ä—Ç–∏—Ä–∞">
                            </div>

                            <div class="form-group">
                                <label class="form-label">–°–ø–æ—Å—ñ–± –æ–ø–ª–∞—Ç–∏ *</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="payment" value="cash" required>
                                        <span class="radio-text">–ì–æ—Ç—ñ–≤–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="payment" value="card">
                                        <span class="radio-text">–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–∫–æ—é –æ–Ω–ª–∞–π–Ω</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">–ö–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</label>
                                <textarea class="form-textarea" id="order-comment"
                                    placeholder="–ë—É–¥—å-—è–∫—ñ –ø–æ–±–∞–∂–∞–Ω–Ω—è..."></textarea>
                            </div>

                            <div class="form-group">
                                <label class="radio-label" style="cursor: pointer;">
                                    <input type="checkbox" id="gift-card">
                                    <span class="radio-text">üéÅ –î–æ–¥–∞—Ç–∏ –ø–æ–¥–∞—Ä—É–Ω–∫–æ–≤—É –ª–∏—Å—Ç—ñ–≤–∫—É (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)</span>
                                </label>
                            </div>

                            <button type="submit" class="btn btn--primary btn--full" id="submit-order-btn">
                                –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer id="site-footer" class="footer"></footer>

    <!-- Success Modal (—Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ –¥–ª—è order page) -->
    <div id="success-overlay" class="modal-overlay"></div>
    <div id="success-modal" class="modal modal--success">
        <div class="modal__content" style="text-align: center;">
            <div class="success-icon">‚úì</div>
            <h3 class="modal__title">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–π–Ω—è—Ç–æ!</h3>
            <p class="modal__text">–î—è–∫—É—î–º–æ –∑–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è! –ù–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –∑–≤'—è–∂–µ—Ç—å—Å—è –∑ –≤–∞–º–∏ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è.</p>
            <p class="modal__text--small">–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É —á–µ—Ä–µ–∑ <span id="countdown">5</span> —Å–µ–∫...</p>
        </div>
    </div>

    <div id="site-modals"></div>

    <script src="js/components.js"></script>
    <script src="js/products-data.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/app.js"></script>

    <script>
        // ===========================
        //  –°–¢–û–†–Ü–ù–ö–ê –ó–ê–ú–û–í–õ–ï–ù–ù–Ø
        // ===========================

        (function () {
            loadOrderItems();

            const form = document.getElementById('order-form');
            if (form) {
                form.addEventListener('submit', function (e) {
                    e.preventDefault();
                    submitOrder();
                });
            }
        })();

        function loadOrderItems() {
            const orderItemsList = document.getElementById('order-items-list');
            const orderTotalElement = document.getElementById('order-total');

            let savedCart;
            try {
                savedCart = JSON.parse(localStorage.getItem('sweetboxCart'));
            } catch (e) {
                savedCart = null;
            }

            if (!savedCart || savedCart.length === 0) {
                orderItemsList.innerHTML = '<p class="order-empty">–í–∞—à –∫–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π. <a href="index.html">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É</a></p>';
                const submitBtn = document.getElementById('submit-order-btn');
                if (submitBtn) submitBtn.disabled = true;
                return;
            }

            orderItemsList.innerHTML = '';
            let total = 0;

            savedCart.forEach(item => {
                const price = parseFloat(item.price.replace(/[^\d.]/g, ''));
                const itemTotal = price * item.quantity;
                total += itemTotal;

                const orderItem = document.createElement('div');
                orderItem.className = 'order-item';
                orderItem.innerHTML = `
                    <div class="order-item__info">
                        <span class="order-item__name">${item.name}</span>
                        <span class="order-item__quantity">√ó ${item.quantity}</span>
                    </div>
                    <span class="order-item__price">${itemTotal.toFixed(0)} ‚Ç¥</span>`;
                orderItemsList.appendChild(orderItem);
            });

            orderTotalElement.textContent = `${total.toFixed(0)} ‚Ç¥`;
        }

        function submitOrder() {
            const orderData = {
                name: document.getElementById('order-name').value,
                phone: document.getElementById('order-phone').value,
                email: document.getElementById('order-email').value,
                delivery: document.querySelector('input[name="delivery"]:checked')?.value,
                address: document.getElementById('order-address').value,
                payment: document.querySelector('input[name="payment"]:checked')?.value,
                comment: document.getElementById('order-comment').value,
                giftCard: document.getElementById('gift-card').checked,
                items: JSON.parse(localStorage.getItem('sweetboxCart') || '[]')
            };

            console.log('–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è:', orderData);

            // –û—á–∏—â–∞—î–º–æ –∫–æ—à–∏–∫
            localStorage.removeItem('sweetboxCart');
            localStorage.removeItem('sweetboxCartCount');

            // –ü–æ–∫–∞–∑—É—î–º–æ –º–æ–¥–∞–ª–∫—É —É—Å–ø—ñ—Ö—É
            const modal = document.getElementById('success-modal');
            const overlay = document.getElementById('success-overlay');
            if (modal) modal.classList.add('show');
            if (overlay) overlay.classList.add('show');

            // Countdown —Ç–∞ redirect
            let seconds = 5;
            const countdownEl = document.getElementById('countdown');
            const timer = setInterval(() => {
                seconds--;
                if (countdownEl) countdownEl.textContent = seconds;
                if (seconds <= 0) {
                    clearInterval(timer);
                    window.location.href = 'index.html';
                }
            }, 1000);
        }
    </script>
</body>

</html>